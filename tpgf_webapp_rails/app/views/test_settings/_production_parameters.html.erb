<div class="production-params-container" data-controller="production-parameters" data-production-section="<%= core_index %>">
  <div class="parameter-header">
    <span>Production Configuration</span>
  </div>
  
  <!-- Flow Orders Selection -->
  <div class="form-group">
    <label class="form-label">Flow Orders</label>
    <select id="flow-orders-<%= ip_type %>-<%= core_index %>" 
            name="ip_configurations[<%= ip_type %>][flow_orders][<%= core_index %>][]" 
            multiple
            placeholder="Search and select flow orders..."
            data-production-parameters-target="flowOrdersSelect">
      <% %w[AVGPSM MINPSM DLDOAVGPSM DLDOMINPSM CPO FAVFS MAFDD DFLL XVMIN XVMINDD].each do |order| %>
        <option value="<%= order %>"><%= order %></option>
      <% end %>
    </select>
  </div>  
  
  <!-- Flow Order Mappings Container -->
  <div data-production-parameters-target="mappingContainer" class="spacer-md"></div>
  
  <!-- Template for flow order mapping -->
  <template id="flow-order-mapping-template">
    <div class="flow-order-mapping" data-order="ORDER">
      <div class="flow-order-header" style="display: flex; justify-content: space-between; align-items: center;">
        <span>ORDER Configuration</span>
      </div>
      
      <!-- Read Type -->
      <div class="form-group">
        <label class="form-label">Read Type <span class="text-red-500">*</span></label>
        <div class="read-type-toggle">
          <button type="button" data-read-type="jtag">
            <input type="checkbox" 
                   name="ip_configurations[IP_TYPE][production_mappings][CORE_INDEX][ORDER][read_type_jtag]"
                   class="sr-only">
            JTAG
          </button>
          <button type="button" data-read-type="fw">
            <input type="checkbox" 
                   name="ip_configurations[IP_TYPE][production_mappings][CORE_INDEX][ORDER][read_type_fw]"
                   class="sr-only">
            FW
          </button>
        </div>
      </div>
      
      <!-- Test Points Sets Counter -->
      <div class="form-group-inline">
        <label class="form-label">Number of Test Point Sets</label>
        <div class="number-input-group">
          <button type="button" 
                  data-action="click->production-parameters#decrementTestPointsSets"
                  data-order="ORDER">−</button>
          <input type="number" 
                 name="ip_configurations[IP_TYPE][production_mappings][CORE_INDEX][ORDER][num_test_points_sets]"
                 value="1" 
                 min="1"
                 max="10"
                 data-test-points-sets-count="ORDER"
                 data-action="change->production-parameters#updateTestPointsSetsCount">
          <button type="button" 
                  data-action="click->production-parameters#incrementTestPointsSets"
                  data-order="ORDER">+</button>
        </div>
      </div>
      
      <!-- Test Points Sets Container -->
      <div data-test-points-sets-container="ORDER" class="test-points-sets-container"></div>
        
      <!-- Other Parameters Grid -->
      <div class="grid grid-cols-2 gap-4">
        <!-- Frequency -->
        <div class="form-group">
          <div class="flex items-center justify-between mb-2">
            <label class="form-label mb-0">Frequency <span class="text-red-500">*</span></label>
            <button type="button" class="use-option-btn" data-use-core-frequency>
              <input type="checkbox" 
                    name="ip_configurations[IP_TYPE][production_mappings][CORE_INDEX][ORDER][use_core_frequency]"
                    class="sr-only">
              Use Core Frequency
            </button>
          </div>
          <div class="input-group">
            <input type="text" 
                  name="ip_configurations[IP_TYPE][production_mappings][CORE_INDEX][ORDER][frequency]"
                  placeholder="e.g., 1000"
                  class="form-input"
                  data-frequency-input="ORDER">
            <span class="input-addon">MHz</span>
          </div>
        </div>
        
        <!-- Register Size -->
        <div class="form-group">
          <label class="form-label">Register Size <span class="text-red-500">*</span></label>
          <input type="text" 
                 name="ip_configurations[IP_TYPE][production_mappings][CORE_INDEX][ORDER][register_size]"
                 placeholder="e.g., 512"
                 class="form-input">
        </div>
        
        <!-- Insertion List -->
        <div class="form-group">
          <label class="form-label">Insertion List</label>
          <select name="ip_configurations[IP_TYPE][production_mappings][CORE_INDEX][ORDER][insertion][]"
                  multiple
                  placeholder="Select insertions..."
                  data-insertion-select="ORDER"
                  class="form-input">
            <option value="WS1">WS1</option>
            <option value="WS2">WS2</option>
            <option value="FT1">FT1</option>
            <option value="FTCOLD">FTCOLD</option>
            <option value="FTCHARZ">FTCHARZ</option>
          </select>
        </div>
      </div>
      
      <!-- Boolean Options -->
      <div class="card-nested">
        <div class="form-label">Options</div>
        <div class="boolean-options-toggle">
          <button type="button" data-boolean-option="binnable">
            <input type="checkbox" 
                   name="ip_configurations[IP_TYPE][production_mappings][CORE_INDEX][ORDER][binnable]"
                   class="sr-only">
            Binnable
          </button>
          <button type="button" data-boolean-option="softsetenable">
            <input type="checkbox" 
                   name="ip_configurations[IP_TYPE][production_mappings][CORE_INDEX][ORDER][softsetenable]"
                   class="sr-only">
            Softset Enable
          </button>
          <button type="button" data-boolean-option="fallbackenable">
            <input type="checkbox" 
                   name="ip_configurations[IP_TYPE][production_mappings][CORE_INDEX][ORDER][fallbackenable]"
                   class="sr-only">
            Fallback Enable
          </button>
        </div>
      </div>
  
      <!-- Repetition Settings -->
      <div class="form-group-inline">
        <label class="form-label">Repetition Settings</label>
        <div class="number-input-group">
          <button type="button" 
                  data-action="click->production-parameters#decrementRepetitions"
                  data-order="ORDER">−</button>
          <input type="number" 
                  name="ip_configurations[IP_TYPE][production_mappings][CORE_INDEX][ORDER][num_repetitions]"
                  value="0" 
                  min="0"
                  max="3"
                  data-repetition-count="ORDER"
                  data-action="change->production-parameters#updateRepetitionCount">
          <button type="button" 
                  data-action="click->production-parameters#incrementRepetitions"
                  data-order="ORDER">+</button>
        </div>
      </div>
      
      <!-- Repetition Fields Container -->
      <div data-repetition-container="ORDER" class="repetition-fields-container"></div>
  
    </div>
  </template>
  
</div>
