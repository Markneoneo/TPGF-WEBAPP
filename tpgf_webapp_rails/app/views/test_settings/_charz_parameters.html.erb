<div class="charz-params-container" data-controller="charz-parameters" data-core-index="<%= core_index %>" data-charz-section>
  <div class="parameter-header">
    <span>Charz Configuration</span>
  </div>
  
  <!-- Search Granularity -->
  <div class="form-group">
    <label class="form-label">Search Granularity <span class="text-red-500">*</span></label>
    <div class="charz-granularity-toggle">
      <% %w[allcore bycore].each do |granularity| %>
        <button type="button" data-granularity="<%= granularity %>">
          <input type="checkbox" 
                 name="ip_configurations[<%= ip_type %>][charz_data][<%= core_index %>][search_granularity][]"
                 value="<%= granularity %>"
                 class="sr-only">
          <%= granularity %>
        </button>
      <% end %>
    </div>
  </div>
  
  <!-- Search Type -->
  <div class="form-group">
    <label class="form-label">Search Type <span class="text-red-500">*</span></label>
    <div class="charz-search-toggle">
      <% %w[VMIN FMAX].each do |search_type| %>
        <button type="button" data-search-type-btn="<%= search_type %>">
          <input type="checkbox" 
                 name="ip_configurations[<%= ip_type %>][charz_data][<%= core_index %>][search_types][]"
                 value="<%= search_type %>"
                 class="sr-only">
          <%= search_type %>
        </button>
      <% end %>
    </div>
  </div>
  
  <!-- Search Type Tables Container -->
  <div data-charz-parameters-target="tablesContainer"></div>
  
  <!-- PSM Register Size -->
  <div class="form-group">
    <label class="form-label">PSM Register Size <span class="text-red-500">*</span></label>
    <input type="text" 
           name="ip_configurations[<%= ip_type %>][charz_data][<%= core_index %>][psm_register_size]"
           placeholder="Enter size"
           class="form-input">
  </div>
</div>

<!-- Template for search type table -->
<template id="search-type-table-template">
  <div class="search-type-section" data-search-type="SEARCH_TYPE">
    <div class="search-type-header">SEARCH_TYPE Test Types</div>
    
    <!-- Spec Variable -->
    <div class="form-group">
      <div class="flex items-center justify-between mb-2">
        <label class="form-label mb-0">SEARCH_TYPE Spec Variable <span class="text-red-500">*</span></label>
        <button type="button" class="use-option-btn" data-use-power-supply-charz>
          <input type="checkbox" 
                 name="ip_configurations[IP_TYPE][charz_data][CORE_INDEX][use_power_supply][SEARCH_TYPE]"
                 class="sr-only">
          Use Power Supply
        </button>
      </div>
      <input type="text" 
             name="ip_configurations[IP_TYPE][charz_data][CORE_INDEX][spec_variables][SEARCH_TYPE]"
             placeholder="Enter spec variable"
             class="form-input">
    </div>
    
    <!-- Test Type Selection -->
    <div class="form-group">
      <label class="form-label">Test Types</label>
      <div class="test-type-toggle">
        <% %w[CREST BIST PBIST].each do |test_type| %>
          <button type="button" data-test-type-btn="<%= test_type %>">
            <input type="checkbox" 
                   name="ip_configurations[IP_TYPE][charz_data][CORE_INDEX][selected_test_types][SEARCH_TYPE][]"
                   value="<%= test_type %>"
                   class="sr-only">
            <%= test_type %>
          </button>
        <% end %>
      </div>
    </div>
    
    <!-- Test Type Table -->
    <div class="table-container">
      <table class="table table-compact">
        <thead>
          <tr>
            <th>Test Type</th>
            <th>WL Count</th>
            <th>Test Points</th>
            <th>Search Start</th>
            <th>Search End</th>
            <th>Search Step</th>
            <th>Resolution</th>
          </tr>
        </thead>
        <tbody data-test-types-tbody>
          <!-- Rows will be added dynamically -->
        </tbody>
      </table>
    </div>
    
    <!-- Workload Table Container -->
    <div class="workload-table-wrapper" data-workload-container></div>
  </div>
</template>
